<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/cli_layout}">

<th:block layout:fragment="content">
    <style>
        .contain {
            display: flex;
            justify-content: center;
            margin-top: 20px;
        }

        #capt {
            width: 170px;
            height: 72px;
            font-size: 37px;
            background-color: #dddde2;
            padding: 5px;
            border: none;
            letter-spacing: 1px;
            float: left;
            color: #2d2e33;
            border-radius: 5px 0 0 5px;
        }

        #refresh {
            float: left;
            background-color: #dddde2;
            height: 82px;
            border-radius: 0 5px 5px 0;
        }

        #refresh img {
            margin-top: 20px;
            cursor: pointer;
        }

        #textinput {
            width: 170px;
            height: 70px;
            font-size: 37px;
            background-color: #dddde2;
            border: none;
            margin-left: 10px;
            border-radius: 5px;
            padding: 5px;
            color: #2d2e33;
        }

        .contain button {
            padding: 8px 20px;
            height: 35px;
            cursor: pointer;
            border: none;
            border-radius: 5px;
            margin-left: 10px;
            margin-top: 25px;
            background-color: #dddde2;
            color: #2d2e33;
            transition: .5s;
        }

    </style>

    <t-h1 ko="회원가입" en="SIGN-UP"></t-h1>
    <t-h2 ko="정보입력"></t-h2>

    <form id="frm" action="/cli/insertMember" method="post" onsubmit="return formCheck()">

        <input type="text" name="memberId" id="memberId" required="required" placeholder="아이디 입력.."/>
        <button type="button" id="checkId"
                class="c-button" value="No" onclick="isIdCheck()">중복체크
        </button>

        <div class="form-group">
            <input type="password" name="password" id="password" placeholder="비밀번호 입력.."/>
        </div>

        <div class="form-group">
            <input type="password" style="-ms-ime-mode: inactive" id="password1" placeholder="비밀번호 확인.."/>
        </div>

        <div class="form-group">
            <input type="text" name="memberName" id="member_name" placeholder="이름 입력.." korOnly/>
        </div>
        <div class="form-group">
            <input type="text" name="tel" id="tel" maxlength="11" minlength="11" placeholder='휴대폰 -없이 입력'
                   oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\..*)\./g, '$1');"/>
        </div>
        <div class="form-group form-button">
            <input type="submit" name="signup" id="signup"
                   class="c-button" value="회원가입"/>
        </div>

    </form>

    <p class="mt-4">
        이미 회원이신가요? <a href="login.html">로그인</a>
    </p>

    <t-h2 ko="매크로 방지"></t-h2>
    <input type="text" id="capt" readonly="readonly">
    <div id="refresh"><img src="/images/refresh.png" width="50px" onclick="cap()"></div>

    <input type="text" id="textinput">
    <button onclick="validcap()">check</button>

    <script>
        $(document).ready(function () {
            $("input[name=memberId]").keyup(function (event) {
                if (!(event.keyCode >= 37 && event.keyCode <= 40)) {
                    var inputVal = $(this).val();
                    $(this).val(inputVal.replace(/[^a-z0-9]/gi, ''));
                }
            });
        });
    </script>
    <script>
        $("input:text[korOnly]").on("keyup", function () {
            $(this).val($(this).val().replace(/[^ㄱ-ㅣ가-힣]/g, ""));
        });
    </script>
    <script>
        function cap() {
            var alpha = ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V'
                , 'W', 'X', 'Y', 'Z', '1', '2', '3', '4', '5', '6', '7', '8', '9', '0', 'a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l', 'm', 'n', 'o', 'p', 'q', 'r', 's', 't', 'u', 'v'
                , 'w', 'x', 'y', 'z'];

            var a = alpha[Math.floor(Math.random() * 62)];
            var b = alpha[Math.floor(Math.random() * 62)];
            var c = alpha[Math.floor(Math.random() * 62)];
            var d = alpha[Math.floor(Math.random() * 62)];
            var e = alpha[Math.floor(Math.random() * 62)];
            var f = alpha[Math.floor(Math.random() * 62)];

            var sum = a + b + c + d + e + f;

            document.getElementById("capt").value = sum;
        }

        var capresult = false;

        function validcap() {
            var string1 = document.getElementById('capt').value;
            var string2 = document.getElementById('textinput').value;
            if (string1 == string2) {
                alert("두 문자가 일치합니다");
                capresult = true;
            } else {
                alert("똑바로 보고 해라");
                capresult = false;

            }
        }

    </script>
    <script type="text/javascript">
        function isIdCheck() {
            let id = $('#memberId').val()
            if (id == "") {
                alert("입력하세요")
                return
            }
            $.ajax({
                url: "/cli/idCheck?memberId=" + $('#memberId').val(),
                type: "get",
                success: function (result) {
                    if (result == 'n') {
                        alert("사용 가능한 아이디입니다.");
                        $("#checkId").attr("class", "c-button disabled");
                        $("#checkId").val('Yes');
                        $("#password").focus();
                    } else {
                        alert("사용 불가능한 아이디입니다.");
                        $("#memberId").val('');
                        $("#memberId").focus();
                    }
                    ;
                }
            });
        }

        function formCheck() {
            if ($("#checkId").val() != 'Yes') {
                alert("아이디 중복체크를 해주세요.");
                return false;
            }

            if ($("#password").val() != $("#password1").val()) {
                alert("패스워드가 일치하지 않습니다.")
                $("#password").val('');
                $("#password1").val('');
                $("#password").focus();
                return false;
            }
            if (capresult == false) {
                alert("다시 확인해 주세요")
                return false;
            }
            return true;
        }
    </script>
</th:block>

</html>



